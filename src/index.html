<!doctype html>
<html>
<head>
    <title>Заклинания D&D 5 редакция</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Заклинания D&D5">
    <link rel="shortcut icon" href="<%= require('./img/favicon.ico') %>" />
    <meta property="og:image" content="<%= require('./img/bg2.jpg') %>" />
    <meta property="og:image" content="<%= require('./img/og.jpg') %>" />
    <meta property="og:title" content="Заклинания D&D 5 редакция" />
    <meta property="og:description" content="Карточки заклинаний на русском и английском языках" />
    <style>
        article, aside, details, figcaption, figure, footer, header,
        hgroup, menu, nav, section, div {
            display: block;
        }
    </style>
</head>
<body>

<div class='wrap' id='app'>
    <div class='p_side' v-cloak>
        <div class="mediaWidth flexParent">
            <a href="/" class="bt flexChild" title="На главную страницу"><i class="fa fa-home"></i></a>
            <a href="#" class="bt flexChild" id="bInfo" title="Справка" v-on:click="showInfo"><i
                    class="fa fa-question-circle"></i></a>
            <a href="#" class="bt flexChild" id="bPrint" title="Распечатать" @click="print"><i class="fa fa-print"
                    aria-hidden="true"></i></a>
        </div>
        <div class='mediaWidth'>
            <searchfield
                    id="NameInput"
                    title="Название"
                    :value="sSearch"
                    :ios="bIos"
                    @input="onSearchName"
                    @searchrndom="getRandomItem"
            >
            </searchfield>
        </div>
        <div class='mediaWidth'>
            <custom-select
                    id="ClassSelect"
                    ref="ClassSelect"
                    title="Класс"
                    :selected="sClassSelected"
                    :items="aClassList"
                    @iclick="onClassChange($event)"
            >
            </custom-select>
        </div>
        <div class='mediaWidth' v-show='aSubClassList.length>1'>
            <custom-select
                    id="SubClassSelect"
                    ref="SubClassSelect"
                    :selected="sSubClassSelected"
                    :items="aSubClassList"
                    @iclick="onSubClassChange($event)"
            >
            </custom-select>
        </div>
        <div class='mediaWidth' v-show='aSubSubClassList.length>1'>
            <custom-select
                    id="SubSubClassSelect"
                    ref="SubSubClassSelect"
                    :selected="sSubSubClassSelected"
                    :items="aSubSubClassList"
                    @iclick="onSubSubClassChange($event)"
            >
            </custom-select>
        </div>


        <div class='mediaWidth' v-show='aSubClassList.length>1'>
            <check-button
                    id="AllSubClassCastsCheckbox"
                    title="Все заклинания класса"
                    tooltip="Все заклинания из этого справочника, которые могут применять представители класса, включая все архетипы"
                    :checked="bAllClassSpells"
                    @press="onAllClassSpellsPress"
            >
            </check-button>
        </div>

        <div class='mediaWidth'>
            <label class='filterLabel'>Уровень с/по</label>
            <div class="row">
                <div class="cell">
                    <custom-select
                            id="LevelSelectStart"
                            ref="LevelSelectStart"
                            :selected="sLevelStartSelected"
                            :items="aLevelList"
                            @iclick="onLevelStartChange($event)"
                    >
                    </custom-select>
                </div>
                <div class="cell">
                    <custom-select
                            id="LevelSelectEnd"
                            ref="LevelSelectEnd"
                            :selected="sLevelEndSelected"
                            :items="aLevelList"
                            @iclick="onLevelEndChange($event)"
                    >
                    </custom-select>
                </div>
            </div>
        </div>

        <div class='mediaWidth'>
            <combobox
                    id="SchoolCombobox"
                    ref="SchoolCombobox"
                    title="Школы"
                    :items="aSchoolList"
                    :opened="bSchoolsOpend"
                    @iclick="onSchoolChange($event)"
                    @opened="onSchoolsToggled($event)"
            >
            </combobox>
        </div>
        <div class='mediaWidth'>
            <combobox
                    id="SourceCombobox"
                    ref="SourceCombobox"
                    title="Источники"
                    :items="aSrcList"
                    :opened="bSourcesOpend"
                    @iclick="onSourceChange($event)"
                    @opened="onSourcesToggled($event)"
            >
            </combobox>
        </div>
        <div class='mediaWidth'>
            <combobox
                    id="CastingTimeCombobox"
                    ref="CastingTimeCombobox"
                    title="Время накладывания"
                    :items="aCastingTimeList"
                    :opened="bCastingTimeOpend"
                    @iclick="onCastingTimeChange($event)"
                    @opened="onCastingTimeToggled($event)"
            >
            </combobox>
        </div>
        <div class='mediaWidth'>
            <check-button
                    id="RitualCheckbox"
                    title="Ритуальные заклинания"
                    :checked="bRitualOnly"
                    @press="onRitualsPress"
            >
            </check-button>
        </div>

        <div class='mediaWidth'>
            <label class='filterLabel'>Ширина карточек</label>
            <div class="flexParent">

                <button
                        class='bt flexChild'
                        title='Уменьшить ширину карточек'
                        @click='makeCardWidthLess'
                >
                    <i class="fa fa-caret-right" aria-hidden="true"></i> <i class="fa fa-caret-left"
                        aria-hidden="true"></i>
                </button>

                <button
                        class='bt flexChild'
                        title='Сбросить ширину карточек'
                        @click='makeCardWidthNorm'
                >
                    <i class="fa fa-square-o" aria-hidden="true"></i>
                </button>

                <button
                        class='bt flexChild'
                        title='Увеличить ширину карточек'
                        @click='makeCardWidthMore'
                >
                    <i class="fa fa-caret-left" aria-hidden="true"></i> <i class="fa fa-caret-right"
                        aria-hidden="true"></i>
                </button>

            </div>
        </div>

        <div class='mediaWidth'>
            <div class="flexParent">
                <button
                        class="bt flexChild"
                        style="    padding: 0.6em; margin: 0;"
                        @click="autosizeAllText"
                >
                    Подстроить текст
                </button>
            </div>
        </div>

        <div class='mediaWidth'>
            <custom-select
                    id="SortSelect"
                    ref="SortSelect"
                    title="Сортировка"
                    :selected="sSortSelected"
                    :items="aSortList"
                    @iclick="onSortChange($event)"
            >
            </custom-select>
        </div>

        <div class='mediaWidth'>
            <custom-select
                    id="LangSelect"
                    ref="LangSelect"
                    title="Язык"
                    :selected="sLangSelected"
                    :items="aLanguageList"
                    @iclick="onLanguageChange($event)"
            >
            </custom-select>
        </div>
        <div class='mediaWidth'>
            <custom-select
                    id="ViewSelect"
                    ref="ViewSelect"
                    title="Вид"
                    :selected="sViewSelected"
                    :items="aViewList"
                    @iclick="onViewChange($event)"
            >
            </custom-select>
        </div>
        <!--
      <div class='mediaWidth'>
        <label></lable>
      </div>
      -->
        <hr>
        <div class='mediaWidth'>
            <button class="btn"
                    title="Скачать базу данных в формате JSON"
                    @click="downloadDB"
            >Скачать
            </button>
        </div>
        <div class='mediaWidth'>
            <input type="file" style="display: none;" ref="fileUploader" id="fileUploader" @change="fileSelected">
            <button class="btn"
                    title="Загрузить базу данных в формате JSON"
                    @click="uploadDB">
                Загрузить
            </button>
        </div>
        <div class='mediaWidth'>
            <check-button
                    id="EditorCheckbox"
                    title="Редактирование"
                    :checked="bEditMode"
                    @press="onEditModePress"
            >
            </check-button>
        </div>


        <div class='mediaWidth' v-show="aHiddenItemsList.length>0">
            <label class="filterLabel">Скрытые заклинания ({{ aHiddenItemsList.length }})</label>
            <div id="HiddenItems">
                <a href='#' class='bReturnUnvisible' @click.stop="unhideAll">Вернуть все обратно</a>
                <hiddenitem
                        v-for="item in aHiddenItemsList"
                        :key="item.id"
                        :id="item.id"
                        :title="item.title"
                        :tooltip="item.tooltip"
                        @unhide="unhideCard(item.id)"
                >
                </hiddenitem>
            </div>
        </div>

    </div>

    <div class='p_cont' ref="cardContainer">
        <div id='lockedItemsArea' v-show="aLockedItemsList.length>0 && bCardsAreVisible" v-cloak>
            <div class='flex_row noprint'>
                <span class='topHeader'>Закрепленные заклинания ({{ aLockedItemsList.length }})</span>
                <span class='bUnlockAll' @click="unlockAll">Открепить все</span>
            </div>
            <div class='content row'>
                <card
                        v-for="item in aLockedItemsList"
                        ref="itemCard"
                        :key="item.name"
                        :id="item.id"
                        :name="item.name"
                        :tooltip="item.tooltip"
                        :text="item.text"
                        :src="item.src"
                        :class-name="item.className"
                        :source="item.source"
                        :school="item.school"
                        :level="item.level"
                        :duration="item.duration"
                        :casting-time="item.castingTime"
                        :range="item.range"
                        :materials="item.materials"
                        :ritual="item.ritual"
                        :components="item.components"
                        :casting-Time-Title="item.castingTimeTitle"
                        :duration-Title="item.durationTitle"
                        :range-Title="item.rangeTitle"
                        :components-Title="item.componentsTitle"
                        :color="item.color"
                        :view="sView"
                        :selected="item.selected"
                        :locked="item.locked"
                        :pre="item.pre"
                        :editable="item.editable"
                        @unlock="unlockCard(item)"
                        @hide="hideCard(item)"
                        @select="selectLockedCard(item)"
                >
                </card>
            </div>
            <div class='flex_row noprint'>
                <span class='bottomHeader'>Каталог заклинаний ({{ aItemsList.length }})</span>
            </div>
        </div>
        <!--span id='before_spells'><div class='loader'></div>Читаем заклинания...</span-->
        <div class="row spellContainer" :class="{noprint: aLockedItemsList.length>0}"
                :data-itemcount="aItemsList.length" v-show="bCardsAreVisible">
            <span class='itemCounter noprint' v-show="aLockedItemsList.length<1" v-cloak
                    title='Количество элементов'>{{ aItemsList.length }}</span>
            <card
                    v-for="item in aItemsList"
                    ref="itemCard"
                    :key="item.name"
                    :id="item.id"
                    :name="item.name"
                    :tooltip="item.tooltip"
                    :text="item.text"
                    :src="item.src"
                    :class-name="item.className"
                    :source="item.source"
                    :school="item.school"
                    :level="item.level"
                    :duration="item.duration"
                    :casting-time="item.castingTime"
                    :range="item.range"
                    :materials="item.materials"
                    :ritual="item.ritual"
                    :components="item.components"
                    :casting-Time-Title="item.castingTimeTitle"
                    :duration-Title="item.durationTitle"
                    :range-Title="item.rangeTitle"
                    :components-Title="item.componentsTitle"
                    :color="item.color"
                    :view="sView"
                    :selected="item.selected"
                    :pre="item.pre"
                    :editable="item.editable"
                    @lock="lockCard(item)"
                    @hide="hideCard(item)"
                    @select="selectCard(item)"
                    @cancel="cancelCard"
                    @input="saveCard"
            >
            </card>
        </div>

        <div class='row spellContainer'>
        </div>
    </div>
    <transition name="fade">
        <modal
                :close-func="closeModWin"
                :show="bModalWinShow"
                v-on:click="showInfo">
        </modal>
    </transition>
</div>
</body>
</html>